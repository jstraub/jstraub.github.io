{{- $posts := "" -}}

{{- if .section -}}
    {{- $posts = (where site.RegularPages "Section" .section) -}}
{{- else -}}
    {{- if (eq .context.Kind "taxonomy") -}}
        {{- $posts = .context.Pages -}}
    {{- else -}}
        {{- if (eq .context.Kind "term") -}}
            {{- $posts = .context.Data.Pages -}}
	{{- else -}}
            {{- $posts = site.RegularPages }}
	{{- end -}}
    {{- end -}}
{{- end -}}

{{- $limit_exceeded:= "" -}}
{{- if (and .limit (gt (len $posts) .limit)) -}}
    {{- $limit_exceeded = true -}}
{{- else -}}
    {{- $limit_exceeded = false -}}
{{ end }}

{{- if (gt (len $posts) 0) }}
    {{- if .limit }}
        {{ $posts = (first .limit $posts ) }}
    {{ end }}
	<table class="paper-list">
        {{- range $post := $posts -}}
		<tr>
			<td class="paper-thumb">
    			<img src="{{ .Params.img }}" alt="{{ $post.Title }}" loading="lazy" />
			</td>
			<td class="paper-info">
            		<a class="paper-title" href="{{ .Params.page }}">{{ $post.Title }}</a>
				<time class="paper-date" datetime="{{ $post.Date.Format "2006-01-02" }}">{{ $post.Date.Format "2006-01-02" }}</time>
    			{{ $post.Content }}
			</td>
		</tr>
        {{ end }}
	</table>
        {{- if and .show_more $limit_exceeded }}
            <p><a href="{{ .show_more_url | relURL }}">{{ .show_more_text | default "Show more..." }}</a></p>
        {{ end }}
{{ end }}
